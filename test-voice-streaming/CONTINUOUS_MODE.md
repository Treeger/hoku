# Continuous Mode - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ—á–∏

## –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å

### ‚úÖ Backend (gRPC Streaming + VAD)
- **Yandex eou_config** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–Ω—Ü–∞ —Ñ—Ä–∞–∑—ã (–ø–∞—É–∑–∞ 1.2 —Å–µ–∫)
- **Continuous STT stream** - –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Å—Ä–∞–∑—É –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–µ—Å—Å–∏–∏
- **–ê–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫** - –ø–æ—Å–ª–µ TTS –æ—Ç–≤–µ—Ç–∞ STT stream –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
- **–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞** - ~1-1.5 —Å–µ–∫—É–Ω–¥—ã –≤–º–µ—Å—Ç–æ 4 —Å–µ–∫—É–Ω–¥

### ‚úÖ Frontend (2 —Ä–µ–∂–∏–º–∞ —Ä–∞–±–æ—Ç—ã)
- **Push-to-Talk** (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) - –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π —Ä–µ–∂–∏–º —Å –∫–Ω–æ–ø–∫–æ–π
- **Continuous (Auto)** - –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–µ —Å –∞–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º –ø–∞—É–∑

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç Continuous Mode

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∫–ª—é—á–∞–µ—Ç —Ä–µ–∂–∏–º "Continuous"
   ‚Üì
2. –ú–∏–∫—Ä–æ—Ñ–æ–Ω –≤–∫–ª—é—á–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
   ‚Üì
3. –ê—É–¥–∏–æ stream –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä
   ‚Üì
4. Yandex VAD –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç:
   - –ù–∞—á–∞–ª–æ —Ä–µ—á–∏ (partial —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã)
   - –ö–æ–Ω–µ—Ü —Ä–µ—á–∏ (–ø–∞—É–∑–∞ 1.2 —Å–µ–∫ ‚Üí final —Ä–µ–∑—É–ª—å—Ç–∞—Ç)
   ‚Üì
5. GPT –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç ‚Üí TTS –æ—Ç–≤–µ—á–∞–µ—Ç
   ‚Üì
6. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–æ–∑–≤—Ä–∞—Ç –∫ –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏—é
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
npm install
cd client && npm install
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞
–£–±–µ–¥–∏—Å—å —á—Ç–æ —Å–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `server/service-account-key.json` —Å –∫–ª—é—á–æ–º Service Account.

### 3. –ó–∞–ø—É—Å–∫
```bash
npm run dev
```

### 4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Push-to-Talk —Ä–µ–∂–∏–º–∞
- –û—Ç–∫—Ä–æ–π http://localhost:5173
- –û—Å—Ç–∞–≤—å —Ä–µ–∂–∏–º "Push-to-Talk"
- –ó–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É ‚Üí –≥–æ–≤–æ—Ä–∏ ‚Üí –æ—Ç–ø—É—Å—Ç–∏
- –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ —Ä–∞—Å–ø–æ–∑–Ω–∞—ë—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### 5. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Continuous —Ä–µ–∂–∏–º–∞
- –ü–µ—Ä–µ–∫–ª—é—á–∏—Å—å –Ω–∞ "Continuous (Auto)"
- –ú–∏–∫—Ä–æ—Ñ–æ–Ω –≤–∫–ª—é—á–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (–∫–Ω–æ–ø–∫–∞ —Å—Ç–∞–Ω–µ—Ç –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ–π)
- –ü—Ä–æ—Å—Ç–æ –≥–æ–≤–æ—Ä–∏ - —Å–∏—Å—Ç–µ–º–∞ —Å–∞–º–∞ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç –∫–æ–≥–¥–∞ —Ç—ã –∑–∞–∫–æ–Ω—á–∏–ª (–ø–∞—É–∑–∞ 1.2 —Å–µ–∫)
- –ü–æ—Å–ª–µ –æ—Ç–≤–µ—Ç–∞ –±–æ—Ç–∞ - —Å–∏—Å—Ç–µ–º–∞ —Å–Ω–æ–≤–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–ª—É—à–∞–µ—Ç

### 6. –ü—Ä–æ–≤–µ—Ä—å –∏–Ω–¥–∏–∫–∞—Ü–∏—é —Å–æ—Å—Ç–æ—è–Ω–∏–π
- `üé§ –°–ª—É—à–∞—é... (Auto)` - –æ–∂–∏–¥–∞–Ω–∏–µ —Ä–µ—á–∏
- `üé§ –†–∞—Å–ø–æ–∑–Ω–∞—é... (Auto)` - —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ partial —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- `ü§ñ –î—É–º–∞—é...` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ GPT
- `üîä –ì–µ–Ω–µ—Ä–∏—Ä—É—é —Ä–µ—á—å...` - —Å–∏–Ω—Ç–µ–∑ TTS
- –í–æ–∑–≤—Ä–∞—Ç –∫ `üé§ –°–ª—É—à–∞—é... (Auto)` - —Ü–∏–∫–ª –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ VAD

–ò–∑–º–µ–Ω–∏ –ø–∞—É–∑—É –≤ `server/sttStreamGrpc.js:97`:

```javascript
eou_config: {
  type: 'DEFAULT',
  default: {
    max_pause_between_words_hint_ms: 1200  // 1.2 —Å–µ–∫ (–º–æ–∂–Ω–æ 800-2000)
  }
}
```

- **800ms** - –±—ã—Å—Ç—Ä—ã–µ –æ—Ç–≤–µ—Ç—ã, –Ω–æ –º–æ–∂–µ—Ç –æ–±—Ä–µ–∑–∞—Ç—å –¥–ª–∏–Ω–Ω—ã–µ —Ñ—Ä–∞–∑—ã
- **1200ms** - –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å
- **2000ms** - –º–µ–¥–ª–µ–Ω–Ω–µ–µ, –Ω–æ —Ç–æ—á–Ω–µ–µ –¥–ª—è –º–µ–¥–ª–µ–Ω–Ω–æ–π —Ä–µ—á–∏

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Voximplant/Zadarma

–¢–µ–∫—É—â–∏–π –∫–æ–¥ **—É–∂–µ –≥–æ—Ç–æ–≤** –¥–ª—è —Ç–µ–ª–µ—Ñ–æ–Ω–∏–∏:

1. **Voximplant SDK** –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –≤–º–µ—Å—Ç–æ –±—Ä–∞—É–∑–µ—Ä–Ω–æ–≥–æ WebSocket
2. –ü–æ–ª—É—á–∞–µ—à—å PCM –∞—É–¥–∏–æ stream –æ—Ç Voximplant
3. –û—Ç–ø—Ä–∞–≤–ª—è–µ—à—å —á–µ—Ä–µ–∑ `sttStream.addAudioChunk(audioData)`
4. TTS chunks –æ—Ç–ø—Ä–∞–≤–ª—è–µ—à—å –æ–±—Ä–∞—Ç–Ω–æ –≤ Voximplant
5. –õ–æ–≥–∏–∫–∞ STT‚ÜíGPT‚ÜíTTS —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–¥–µ–Ω—Ç–∏—á–Ω–æ

–°–º. –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ `server/index.js:67-73`

## –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### Push-to-Talk —Ä–µ–∂–∏–º:
- STT: ~400ms (streaming)
- GPT: ~600ms (40 tokens)
- TTS: ~500ms (streaming)
- **–ò—Ç–æ–≥–æ: ~1.5 —Å–µ–∫—É–Ω–¥—ã**

### Continuous —Ä–µ–∂–∏–º:
- STT: –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å—Ä–∞–∑—É –ø—Ä–∏ —Ä–µ—á–∏ (partial results)
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–∞—É–∑—ã: +1.2 —Å–µ–∫ (eou_config)
- GPT + TTS: ~1.1 —Å–µ–∫
- **–ò—Ç–æ–≥–æ: ~2.3 —Å–µ–∫—É–Ω–¥—ã** (–≤–∫–ª—é—á–∞—è –ø–∞—É–∑—É)

### –°—Ç–∞—Ä—ã–π REST API (–¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è):
- STT: 1.5-1.9 —Å–µ–∫
- GPT: 0.7-1 —Å–µ–∫
- TTS: 1.1-1.2 —Å–µ–∫
- **–ò—Ç–æ–≥–æ: ~4 —Å–µ–∫—É–Ω–¥—ã**

## –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –¥–ª—è production

‚úÖ **–ì–æ—Ç–æ–≤–æ:**
- gRPC Streaming API
- –ê–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ—á–∏ (Yandex VAD)
- Continuous mode
- –ê–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ stream
- Partial —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

‚è≥ **–î–ª—è —Ç–µ–ª–µ—Ñ–æ–Ω–∏–∏ –Ω—É–∂–Ω–æ:**
- –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å Voximplant/Zadarma SDK
- –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–≥–æ–≤–æ—Ä–æ–≤
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤–æ–±–æ–¥–Ω—ã—Ö —Å–ª–æ—Ç–æ–≤ (–¥–ª—è –∑–∞–ø–∏—Å–∏ –Ω–∞ –ø—Ä–∏—ë–º)
- –ü–∞—Ä—Å–∏–Ω–≥ –¥–∞—Ç/–≤—Ä–µ–º–µ–Ω–∏ –∏–∑ —Ä–µ—á–∏

## Troubleshooting

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∞–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–∞—É–∑—ã
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ `eou_config` –¥–æ–±–∞–≤–ª–µ–Ω –≤ `sttStreamGrpc.js`

**–ü—Ä–æ–±–ª–µ–º–∞:** –°–ª–∏—à–∫–æ–º –±—ã—Å—Ç—Ä–æ –æ–±—Ä–µ–∑–∞–µ—Ç —Ñ—Ä–∞–∑—ã
**–†–µ—à–µ–Ω–∏–µ:** –£–≤–µ–ª–∏—á—å `max_pause_between_words_hint_ms` –¥–æ 1500-2000ms

**–ü—Ä–æ–±–ª–µ–º–∞:** Continuous mode –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å console - –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å "‚è±Ô∏è STT Streaming - –∑–∞–ø—É—Å–∫" –ø—Ä–∏ init

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ—Å–ª–µ TTS –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –∫ –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏—é
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ `setTimeout(() => startSTTStream(), 500)` –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ `onTTSEnd`
