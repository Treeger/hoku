# üé§ Test Voice - –ì–æ–ª–æ—Å–æ–≤–æ–π –¥–∏–∞–ª–æ–≥ —Å Yandex SpeechKit

–ü—Ä–æ—Å—Ç–æ–π –ø—Ä–æ—Ç–æ—Ç–∏–ø –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ –¥–∏–∞–ª–æ–≥–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Yandex SpeechKit –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –∏ —Å–∏–Ω—Ç–µ–∑–∞ —Ä–µ—á–∏ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
npm install
```

### 2. –ü–æ–ª—É—á–µ–Ω–∏–µ API –∫–ª—é—á–µ–π Yandex Cloud

**üìñ –ü–æ–ª–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:** —Å–º. —Ñ–∞–π–ª `YANDEX_API_SETUP.md`

–ö—Ä–∞—Ç–∫–æ:
1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ [cloud.yandex.ru](https://cloud.yandex.ru)
2. –°–æ–∑–¥–∞–π—Ç–µ —Å–µ—Ä–≤–∏—Å–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç
3. –î–æ–±–∞–≤—å—Ç–µ —Ä–æ–ª–∏: `ai.speechkit-stt.user` –∏ `ai.speechkit-tts.user`
4. –°–æ–∑–¥–∞–π—Ç–µ API –∫–ª—é—á

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –Ω–∞ –æ—Å–Ω–æ–≤–µ `.env.example`:

```bash
cp .env.example .env
```

–ó–∞–ø–æ–ª–Ω–∏—Ç–µ:

```env
YANDEX_API_KEY=AQVN...–≤–∞—à_–∫–ª—é—á
FOLDER_ID=b1g...–≤–∞—à_folder_id
PORT=3000
```

### 4. –ó–∞–ø—É—Å–∫

```bash
npm start
```

–ò–ª–∏ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Å –∞–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–æ–π:

```bash
npm run dev
```

–û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä: **http://localhost:3000**

## üìã –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

1. **–†–∞–∑—Ä–µ—à–∏—Ç–µ –¥–æ—Å—Ç—É–ø –∫ –º–∏–∫—Ä–æ—Ñ–æ–Ω—É** –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ
2. **–ù–∞–∂–º–∏—Ç–µ –∏ —É–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ** –∫–Ω–æ–ø–∫—É "–ù–∞–∂–º–∏ –∏ –≥–æ–≤–æ—Ä–∏"
3. **–ì–æ–≤–æ—Ä–∏—Ç–µ** –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ
4. **–û—Ç–ø—É—Å—Ç–∏—Ç–µ** –∫–Ω–æ–ø–∫—É
5. **–ü–æ–¥–æ–∂–¥–∏—Ç–µ** - —Ç–µ–∫—Å—Ç –±—É–¥–µ—Ç —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω, AI –æ—Ç–≤–µ—Ç–∏—Ç –≥–æ–ª–æ—Å–æ–º

### –ü—Ä–∏–º–µ—Ä—ã —Ñ—Ä–∞–∑ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

- "–ü—Ä–∏–≤–µ—Ç" ‚Üí –ø–æ–ª—É—á–∏—Ç–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
- "–ü–æ–º–æ–≥–∏" / "–ß—Ç–æ —Ç—ã —É–º–µ–µ—à—å" ‚Üí –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è—Ö
- "–°–ø–∞—Å–∏–±–æ" ‚Üí –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å
- "–ü–æ–∫–∞" / "–î–æ —Å–≤–∏–¥–∞–Ω–∏—è" ‚Üí –ø—Ä–æ—â–∞–Ω–∏–µ
- –õ—é–±–∞—è –¥—Ä—É–≥–∞—è —Ñ—Ä–∞–∑–∞ ‚Üí –æ–±—â–∏–π –æ—Ç–≤–µ—Ç

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
test-voice/
‚îú‚îÄ‚îÄ server/
‚îÇ   ‚îú‚îÄ‚îÄ index.js      # Express —Å–µ—Ä–≤–µ—Ä + API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ dialog.js     # –õ–æ–≥–∏–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º
‚îú‚îÄ‚îÄ public/
‚îÇ   ‚îú‚îÄ‚îÄ index.html    # UI –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
‚îÇ   ‚îú‚îÄ‚îÄ app.js        # –õ–æ–≥–∏–∫–∞ –∑–∞–ø–∏—Å–∏ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∞—É–¥–∏–æ
‚îÇ   ‚îî‚îÄ‚îÄ style.css     # –°—Ç–∏–ª–∏
‚îú‚îÄ‚îÄ .env              # API –∫–ª—é—á–∏ (—Å–æ–∑–¥–∞—Ç—å –≤—Ä—É—á–Ω—É—é)
‚îú‚îÄ‚îÄ .env.example      # –ü—Ä–∏–º–µ—Ä —Ñ–∞–π–ª–∞ .env
‚îú‚îÄ‚îÄ package.json
‚îî‚îÄ‚îÄ README.md
```

### API Endpoints

#### `POST /api/dialog`
–ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª –¥–∏–∞–ª–æ–≥–∞: —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ ‚Üí –ª–æ–≥–∏–∫–∞ ‚Üí —Å–∏–Ω—Ç–µ–∑

**Request:**
- `FormData` —Å –ø–æ–ª–µ–º `audio` (WebM/OGG —Ñ–∞–π–ª)

**Response:**
```json
{
  "userText": "–ü—Ä–∏–≤–µ—Ç",
  "responseText": "–ü—Ä–∏–≤–µ—Ç! –ö–∞–∫ –¥–µ–ª–∞?",
  "audio": "base64_encoded_audio"
}
```

#### `POST /api/recognize`
–¢–æ–ª—å–∫–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ä–µ—á–∏ (Speech-to-Text)

**Response:**
```json
{
  "text": "—Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç"
}
```

#### `POST /api/synthesize`
–¢–æ–ª—å–∫–æ —Å–∏–Ω—Ç–µ–∑ —Ä–µ—á–∏ (Text-to-Speech)

**Request:**
```json
{
  "text": "–¢–µ–∫—Å—Ç –¥–ª—è –æ–∑–≤—É—á–∫–∏"
}
```

**Response:** –∞—É–¥–∏–æ —Ñ–∞–π–ª (audio/ogg)

## üîß –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

**Backend:**
- Node.js + Express
- Yandex SpeechKit API (REST)
- Multer (–∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤)
- Axios (HTTP –∫–ª–∏–µ–Ω—Ç)

**Frontend:**
- Vanilla JavaScript
- MediaRecorder API (–∑–∞–ø–∏—Å—å –∞—É–¥–∏–æ)
- Fetch API

## üìù –í–µ—Ä—Å–∏—è 2: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å AI

–î–ª—è –≤—Ç–æ—Ä–æ–π –≤–µ—Ä—Å–∏–∏ —Å –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–º AI (YandexGPT, OpenAI, etc.):

1. –ó–∞–º–µ–Ω–∏—Ç–µ –ª–æ–≥–∏–∫—É –≤ `server/dialog.js`
2. –î–æ–±–∞–≤—å—Ç–µ –≤—ã–∑–æ–≤ AI API –≤–º–µ—Å—Ç–æ –ø—Ä–æ—Å—Ç—ã—Ö –ø—Ä–∞–≤–∏–ª
3. –ü–µ—Ä–µ–¥–∞–≤–∞–π—Ç–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–∏–∞–ª–æ–≥–∞ –¥–ª—è –±–æ–ª–µ–µ —É–º–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤

–ü—Ä–∏–º–µ—Ä –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å OpenAI:

```javascript
import OpenAI from 'openai';

const openai = new OpenAI({ apiKey: process.env.OPENAI_API_KEY });

export async function getResponse(recognizedText) {
  const completion = await openai.chat.completions.create({
    model: "gpt-3.5-turbo",
    messages: [
      { role: "system", content: "–¢—ã –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π –≥–æ–ª–æ—Å–æ–≤–æ–π –ø–æ–º–æ—â–Ω–∏–∫" },
      { role: "user", content: recognizedText }
    ]
  });

  return completion.choices[0].message.content;
}
```

## üêõ Troubleshooting

### –û—à–∏–±–∫–∞ "–Ω–µ –∑–∞–¥–∞–Ω—ã YANDEX_API_KEY –∏–ª–∏ FOLDER_ID"
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `.env`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –∫–ª—é—á–µ–π –≤ `.env`

### –û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –º–∏–∫—Ä–æ—Ñ–æ–Ω—É
- –†–∞–∑—Ä–µ—à–∏—Ç–µ –¥–æ—Å—Ç—É–ø –∫ –º–∏–∫—Ä–æ—Ñ–æ–Ω—É –≤ –±—Ä–∞—É–∑–µ—Ä–µ
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS –∏–ª–∏ localhost

### –ê—É–¥–∏–æ –Ω–µ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤–∞—à –±—Ä–∞—É–∑–µ—Ä –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç MediaRecorder API
- –ü–æ–ø—Ä–æ–±—É–π—Ç–µ Chrome/Edge (–ª—É—á—à–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞)

### –û—à–∏–±–∫–∞ "Unauthorized" –æ—Ç Yandex API
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å API –∫–ª—é—á–∞
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–µ—Ä–≤–∏—Å–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç –∏–º–µ–µ—Ç –Ω—É–∂–Ω—ã–µ —Ä–æ–ª–∏
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Folder ID –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [Yandex SpeechKit Documentation](https://cloud.yandex.ru/docs/speechkit/)
- [MediaRecorder API](https://developer.mozilla.org/en-US/docs/Web/API/MediaRecorder)
- [Yandex Cloud Pricing](https://cloud.yandex.ru/docs/speechkit/pricing)

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT

---

**–ê–≤—Ç–æ—Ä:** Konstantin
**–í–µ—Ä—Å–∏—è:** 1.0 (–±–∞–∑–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º)
